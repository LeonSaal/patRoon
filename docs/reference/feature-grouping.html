<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Grouping of features — feature-grouping • patRoon</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Grouping of features — feature-grouping" />
<meta property="og:description" content="Functions and classes for grouping of features across analyses." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patRoon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">Online</a>
    </li>
    <li>
      <a href="../reference/patRoon.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Online HTML page</a>
    </li>
    <li>
      <a href="../articles/tutorial.pdf">PDF</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Handbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../handbook_bd/index.html">Book format</a>
    </li>
    <li>
      <a href="../handbook_bd/handbook.pdf">PDF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rickhelmus/patRoon">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Grouping of features</h1>
    <small class="dont-index">Source: <a href='https://github.com/rickhelmus/patRoon/blob/master/R/main.R'><code>R/main.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups.R'><code>R/feature_groups.R</code></a>, <a href='https://github.com/rickhelmus/patRoon/blob/master/R/feature_groups-set.R'><code>R/feature_groups-set.R</code></a>, and 7 more</small>
    <div class="hidden name"><code>feature-grouping.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions and classes for grouping of features across analyses.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for features</span>
<span class='fu'>groupFeatures</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>algorithm</span>, <span class='va'>...</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># S4 method for data.frame</span>
<span class='fu'>groupFeatures</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>algorithm</span>, <span class='va'>...</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>importFeatureGroups</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>type</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for featuresSet</span>
<span class='fu'>groupFeatures</span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>algorithm</span>, <span class='va'>...</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># S4 method for featureGroups</span>
<span class='fu'><a href='generics.html'>makeSet</a></span><span class='op'>(</span>
  <span class='va'>obj</span>,
  <span class='va'>...</span>,
  <span class='va'>groupAlgo</span>,
  groupArgs <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  adducts <span class='op'>=</span> <span class='cn'>NULL</span>,
  labels <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='co'># S4 method for featureGroupsSet</span>
<span class='fu'><a href='generics.html'>makeSet</a></span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>importFeatureGroupsBrukerPA</span><span class='op'>(</span>
  <span class='va'>path</span>,
  <span class='va'>feat</span>,
  rtWindow <span class='op'>=</span> <span class='fl'>12</span>,
  mzWindow <span class='op'>=</span> <span class='fl'>0.005</span>,
  intWindow <span class='op'>=</span> <span class='fl'>5</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>importFeatureGroupsEnviMass</span><span class='op'>(</span><span class='va'>path</span>, <span class='va'>feat</span>, <span class='va'>positive</span><span class='op'>)</span>

<span class='co'># S4 method for features</span>
<span class='fu'>groupFeaturesKPIC2</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  rtalign <span class='op'>=</span> <span class='cn'>TRUE</span>,
  loadRawData <span class='op'>=</span> <span class='cn'>TRUE</span>,
  groupArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tolerance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.005</span>, <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>,
  alignArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for featuresSet</span>
<span class='fu'>groupFeaturesKPIC2</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  groupArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>tolerance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.005</span>, <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>importFeatureGroupsKPIC2</span><span class='op'>(</span><span class='va'>picsSetGrouped</span>, <span class='va'>analysisInfo</span><span class='op'>)</span>

<span class='co'># S4 method for featureGroupsKPIC2</span>
<span class='fu'><a href='generics.html'>delete</a></span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for features</span>
<span class='fu'>groupFeaturesOpenMS</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  rtalign <span class='op'>=</span> <span class='cn'>TRUE</span>,
  QT <span class='op'>=</span> <span class='cn'>FALSE</span>,
  maxAlignRT <span class='op'>=</span> <span class='fl'>30</span>,
  maxAlignMZ <span class='op'>=</span> <span class='fl'>0.005</span>,
  maxGroupRT <span class='op'>=</span> <span class='fl'>12</span>,
  maxGroupMZ <span class='op'>=</span> <span class='fl'>0.005</span>,
  extraOptsRT <span class='op'>=</span> <span class='cn'>NULL</span>,
  extraOptsGroup <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>groupFeaturesSIRIUS</span><span class='op'>(</span><span class='va'>analysisInfo</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># S4 method for features</span>
<span class='fu'>groupFeaturesXCMS</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  rtalign <span class='op'>=</span> <span class='cn'>TRUE</span>,
  loadRawData <span class='op'>=</span> <span class='cn'>TRUE</span>,
  groupArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mzwid <span class='op'>=</span> <span class='fl'>0.015</span><span class='op'>)</span>,
  retcorArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"obiwarp"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for featuresSet</span>
<span class='fu'>groupFeaturesXCMS</span><span class='op'>(</span><span class='va'>feat</span>, groupArgs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mzwid <span class='op'>=</span> <span class='fl'>0.015</span><span class='op'>)</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>importFeatureGroupsXCMS</span><span class='op'>(</span><span class='va'>xs</span>, <span class='va'>analysisInfo</span><span class='op'>)</span>

<span class='co'># S4 method for featureGroupsXCMS</span>
<span class='fu'><a href='generics.html'>delete</a></span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for features</span>
<span class='fu'>groupFeaturesXCMS3</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  rtalign <span class='op'>=</span> <span class='cn'>TRUE</span>,
  loadRawData <span class='op'>=</span> <span class='cn'>TRUE</span>,
  groupParam <span class='op'>=</span> <span class='fu'>xcms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks-density.html'>PeakDensityParam</a></span><span class='op'>(</span>sampleGroups <span class='op'>=</span> <span class='fu'><a href='generics.html'>analysisInfo</a></span><span class='op'>(</span><span class='va'>feat</span><span class='op'>)</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>,
  preGroupParam <span class='op'>=</span> <span class='va'>groupParam</span>,
  retAlignParam <span class='op'>=</span> <span class='fu'>xcms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-obiwarp.html'>ObiwarpParam</a></span><span class='op'>(</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S4 method for featuresSet</span>
<span class='fu'>groupFeaturesXCMS3</span><span class='op'>(</span>
  <span class='va'>feat</span>,
  groupParam <span class='op'>=</span> <span class='fu'>xcms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks-density.html'>PeakDensityParam</a></span><span class='op'>(</span>sampleGroups <span class='op'>=</span> <span class='fu'><a href='generics.html'>analysisInfo</a></span><span class='op'>(</span><span class='va'>feat</span><span class='op'>)</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>importFeatureGroupsXCMS3</span><span class='op'>(</span><span class='va'>xdata</span>, <span class='va'>analysisInfo</span><span class='op'>)</span>

<span class='co'># S4 method for featureGroupsXCMS3</span>
<span class='fu'><a href='generics.html'>delete</a></span><span class='op'>(</span><span class='va'>obj</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>Either a <code><a href='features-class.html'>features</a></code> object to be grouped, or a <code>data.frame</code> with
<a href='analysis-information.html'>analysis info</a> to be passed to <code>groupFeaturesSIRIUS</code> or a <code>featureGroups</code>
objects passed to <code>makeSet</code>.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>A <code>character</code> that specifies the algorithm to be used: either <code>"openms"</code>, <code>"xcms"</code>,
<code>"xcms3"</code> or <code>"kpic2"</code> (<code>features method</code>), or <code>"sirius"</code> (<code>data.frame</code> method).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any parameters to be passed to the selected grouping/importing algorithm.</p>
<p>For <code>makeSet</code>: further <code><a href='featureGroups-class.html'>featureGroups</a></code> objects that should be used for the
  <a href='sets-workflow.html'>sets workflow</a>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if <code>FALSE</code> then no text output will be shown.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>The path that should be used for importing. For
<code>importFeatureGroupsBrukerPA</code> an exported 'bucket table' <code class="file">.txt</code>
file from Bruker ProfileAnalysis, for <code>importFeatureGroupsBrukerTASQ</code>
an exported global result table (converted to <code class="file">.csv</code>) and for
<code>importFeatureGroupsEnviMass</code> the path of the enviMass project.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Which file type should be imported or exported: <code>"brukerpa"</code> (Bruker ProfileAnalysis),
<code>"brukertasq"</code> (Bruker TASQ), <code>envimass</code> (<span class="pkg">enviMass</span>, only import) or <code>"mzmine"</code> (MZMine, only
export).</p></td>
    </tr>
    <tr>
      <th>groupAlgo</th>
      <td><p>groupAlgo The name of the feature grouping algorithm. See the <code>algorithm</code> argument description.</p></td>
    </tr>
    <tr>
      <th>groupArgs</th>
      <td><p>A <code>list</code> with arguments directly passed to <code>groupFeatures</code> (can be named). Example:
<code>groupArgs=list(maxAlignMZ=0.002)</code>.</p></td>
    </tr>
    <tr>
      <th>adducts</th>
      <td><p>The adduct assignments to each set. Should either be a <code>list</code> with <code><a href='adduct-class.html'>adduct</a></code> objects
or a <code>character</code> vector (<em>e.g.</em> <code>"[M+H]+"</code>). The order should follow that of the objects given to
the <code>obj</code> and <code>...</code> arguments. if <code>NULL</code> then adduct annotations
are used.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>The labels, or <em>set names</em>, for each set to be created. The order should follow that of the
objects given to the <code>obj</code> and <code>...</code> arguments. If <code>NULL</code>, then labels are automatically generated
from the polarity of the specified <code>adducts</code> argument (<em>e.g.</em> <code>"positive"</code>, <code>"negative"</code>).</p></td>
    </tr>
    <tr>
      <th>feat</th>
      <td><p>The <code><a href='features-class.html'>features</a></code> to be grouped. <code>importFeatureGroupsBrukerPA</code> and
<code>importFeatureGroupsEnviMass</code> only support features generated by <code><a href='feature-finding.html'>findFeaturesBruker</a></code> and
<code><a href='feature-finding.html'>importFeaturesEnviMass</a></code>, respectively.</p></td>
    </tr>
    <tr>
      <th>rtWindow, mzWindow, intWindow</th>
      <td><p>Search window values for retention time
(seconds), <em>m/z</em> (Da) and intensity used to find back features within
feature groups from PA (+/- the retention/mass/intensity value of a
feature).</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Warn about missing or duplicate features when relating them back
from grouped features.</p></td>
    </tr>
    <tr>
      <th>positive</th>
      <td><p>Whether data from positive (<code>TRUE</code>) or negative
(<code>FALSE</code>) should be loaded.</p></td>
    </tr>
    <tr>
      <th>rtalign</th>
      <td><p>Enable retention time alignment.</p></td>
    </tr>
    <tr>
      <th>loadRawData</th>
      <td><p>Set to <code>TRUE</code> if analyses are available as <code>mzXML</code> or <code>mzML</code> files. Otherwise MS
data is not loaded, and some dummy data (<em>e.g.</em> file paths) is used in the returned object.</p></td>
    </tr>
    <tr>
      <th>alignArgs</th>
      <td><p>named <code>character vector</code> that may contain extra parameters to be used by
<code><a href='https://rdrr.io/pkg/KPIC/man/PICset.align.html'>KPIC::PICset.align</a></code>.</p></td>
    </tr>
    <tr>
      <th>picsSetGrouped</th>
      <td><p>A grouped <code>PIC set</code> object (<em>e.g.</em> as returned by
<code><a href='https://rdrr.io/pkg/KPIC/man/PICset.group.html'>KPIC::PICset.group</a></code>).</p></td>
    </tr>
    <tr>
      <th>analysisInfo</th>
      <td><p>A <code>data.frame</code> with <a href='analysis-information.html'>analysis info</a>.</p></td>
    </tr>
    <tr>
      <th>QT</th>
      <td><p>If enabled, use <code class='command'>FeatureLinkerUnlabeledQT</code> instead of
<code class='command'>FeatureLinkerUnlabeled</code> for feature grouping.</p></td>
    </tr>
    <tr>
      <th>maxAlignRT, maxAlignMZ</th>
      <td><p>Used for retention alignment. Maximum retention
time or m/z difference (seconds/Dalton) for feature pairing. Sets
<code>-algorithm:pairfinder:distance_RT:max_difference</code> and
<code>-algorithm:pairfinder:distance_MZ:max_difference</code> otpions,
respectively.</p></td>
    </tr>
    <tr>
      <th>maxGroupRT, maxGroupMZ</th>
      <td><p>as <code>maxAlignRT</code> and <code>maxAlignMZ</code>, but
for grouping of features. Sets <code>-algorithm:distance_RT:max_difference</code>
and <code>-algorithm:distance_MZ:max_difference</code> options, respectively.</p></td>
    </tr>
    <tr>
      <th>extraOptsRT, extraOptsGroup</th>
      <td><p>Named <code>list</code> containing extra options
that will be passed to <code class='command'>MapAlignerPoseClustering</code> or
<code class='command'>FeatureLinkerUnlabeledQT/FeatureLinkerUnlabeled</code>, respectively.
Any options specified here will override any of the above. Example:
<code>extraOptsGroup=list("-algorithm:distance_RT:max_difference"=12)</code>
(corresponds to setting <code>maxGroupRT=12</code>). Set to <code>NULL</code> to
ignore.</p></td>
    </tr>
    <tr>
      <th>retcorArgs</th>
      <td><p>named <code>character vector</code> that may contain extra parameters to be used by
<code><a href='https://rdrr.io/pkg/xcms/man/retcor-methods.html'>xcms::retcor</a></code>.</p></td>
    </tr>
    <tr>
      <th>xs</th>
      <td><p>An <code>xcmsSet</code> object.</p></td>
    </tr>
    <tr>
      <th>groupParam, retAlignParam</th>
      <td><p>parameter object that is directly passed to
<code><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks.html'>xcms::groupChromPeaks</a></code> and <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime.html'>xcms::adjustRtime</a></code>,
respectively.</p></td>
    </tr>
    <tr>
      <th>preGroupParam</th>
      <td><p>grouping parameters applied when features are grouped <em>prior</em> to alignment (only with peak
groups alignment).</p></td>
    </tr>
    <tr>
      <th>xdata</th>
      <td><p>An <code>XCMSnExp</code> object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of a class which is derived from <code><a href='featureGroups-class.html'>featureGroups</a></code>.</p>
<p><code>makeSet</code> and the <code><a href='features-class.html'>featuresSet</a></code> method of <code>groupFeatures</code> return a
  <code><a href='featureGroups-class.html'>featureGroupsSet</a></code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>After <a href='feature-finding.html'>features have been found</a> the logical next step is to align and group them across
analyses. This process is necessary to allow comparison of features between multiple analyses, which otherwise would
be difficult due to small deviations in retention and mass data. Thus, algorithms of 'feature groupers' are used to
collect features with similar retention and mass data. In addition, advanced retention time alignment algorithms
exist to enhance grouping of features even with relative large retention time deviations (<em>e.g.</em> possibly
observed from analyses collected over a long period). Like <a href='feature-finding.html'>finding of features</a>, various
algorithms are supported which may have many parameters that can be fine-tuned. This fine-tuning is likely to be
necessary, since optimal settings often depend on applied methodology and instrumentation.</p>
<p><code>groupFeatures</code> is a generic function that will group features using one of the supported algorithms. The actual
  functionality is provided by algorithm specific functions such as <code>groupFeaturesOpenMS</code> and <code>groupFeaturesXCMS3</code>. While these
  functions may be called directly, <code>groupFeatures</code> provides a generic interface and is therefore usually preferred.</p>
<p>The <code>data.frame</code> method for <code>groupFeatures</code> is a special case that currently only supports the
  <code>"sirius"</code> algorithm.</p>
<p><code>importFeatureGroups</code> is a generic function to import feature
  groups produced by other software. The actual functionality is provided by
  specific functions such as <code>importFeatureGroupsBrukerPA</code> and
  <code>importFeatureGroupsEnviMass</code>.</p>
<p><code>makeSet</code> is used to initiate a <a href='sets-workflow.html'>sets workflow</a>. See the <code>Sets workflows</code>
  section for more details.</p>
<p><code>importFeatureGroupsBrukerPA</code> imports grouped features
  generated with Bruker ProfileAnalysis (PA). To do so, a 'bucket table'
  should be generated using PA and exported as <code class="file">.txt</code> file. Please note
  that this function only supports features generated by
  <code><a href='feature-finding.html'>findFeaturesBruker</a></code> and it is <strong>crucial</strong> that
  DataAnalysis files remain unchanged when features are collected and the
  bucket table is generated. Furthermore, please note that PA does not retain
  information about originating features for generated buckets. For this
  reason, this function tries to find back the original features and care
  must be taken to correctly specify search parameters (<code>rtWindow</code>,
  <code>mzWindow</code>, <code>intWindow</code>).</p>
<p><code>importFeatureGroupsEnviMass</code> imports grouped features
  ('profiles') generated with <span class="pkg">enviMass</span>. Note that this function
  <em>only</em> imports 'raw' profiles, <em>not</em> any results from further
  componentization steps performed in <span class="pkg">enviMass</span>. Furthermore, this
  functionality has only been tested with older versions of <span class="pkg">enviMass</span>.
  Finally, please note that this function only supports features imported by
  <code><a href='feature-finding.html'>importFeaturesEnviMass</a></code> (obviously, the same project should be
  used for both importing functions).</p>
<p><code>groupFeaturesKPIC2</code> uses the the
  <a href='https://github.com/hcji/KPIC2'>KPIC2</a> <span style="R">R</span> package for grouping of features. Grouping of features and alignment of
  their retention times are performed with the
  <code><a href='https://rdrr.io/pkg/KPIC/man/PICset.group.html'>KPIC::PICset.group</a></code> and
  <code><a href='https://rdrr.io/pkg/KPIC/man/PICset.align.html'>KPIC::PICset.align</a></code> functions, respectively.</p>
<p><code>importFeatureGroupsKPIC2</code> imports grouped features from an <span class="pkg">KPIC</span> object.</p>
<p><code>groupFeaturesOpenMS</code> uses the OpenMS tools for grouping of
  features (see <a href='http://www.openms.de'>http://www.openms.de</a>). Retention times may be aligned
  by the
  <a href='https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_MapAlignerPoseClustering.html'>MapAlignerPoseClustering</a>
   TOPP tool. Grouping is achieved by either the
  <a href='https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_FeatureLinkerUnlabeled.html'>FeatureLinkerUnlabeled</a>
   or
  <a href='https://abibuilder.informatik.uni-tuebingen.de/archive/openms/Documentation/release/latest/html/TOPP_FeatureLinkerUnlabeledQT.html'>FeatureLinkerUnlabeledQT</a>
   TOPP tools.</p>
<p><code>groupFeaturesSIRIUS</code> uses <a href='https://bio.informatik.uni-jena.de/software/sirius/'>SIRIUS</a> to find
  <em>and</em> group features. This is done by running the <code class='command'>lcms-align</code> command on every analyses at once. Note
  that grouping feature data from other algorithms than <code class='command'>SIRIUS</code> are therefore not supported.</p>
<p><code>groupFeaturesXCMS</code> uses the <span class="pkg">xcms</span> package for grouping of features. Grouping of features and
  alignment of their retention times are performed with the <code><a href='https://rdrr.io/pkg/xcms/man/group-methods.html'>xcms::group</a></code> and
  <code><a href='https://rdrr.io/pkg/xcms/man/retcor-methods.html'>xcms::retcor</a></code> functions, respectively. Both functions have an extensive list of
  parameters to modify their behaviour and may therefore be used to potentially optimize results.</p>
<p><code>importFeatureGroupsXCMS</code> converts grouped features from an
  <code>xcmsSet</code> object (from the <span class="pkg">xcms</span> package).</p>
<p><code>groupFeaturesXCMS3</code> uses the new interface from the <span class="pkg">xcms</span> package for grouping of features.
  Grouping of features and alignment of their retention times are performed with the
  <code><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks.html'>xcms::groupChromPeaks</a></code> and <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime.html'>xcms::adjustRtime</a></code>
  functions, respectively. Both of these functions support an extensive amount of parameters that modify their
  behaviour and may therefore require optimization.</p>
<p><code>importFeatureGroupsXCMS3</code> converts grouped features from an
  <code>XCMSnExp</code> object (from the <span class="pkg">xcms</span> package).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In most cases it will be necessary to centroid your MS input files. The only exception is <code class='command'>Bruker</code>,
  however, you will still need centroided <code class="file">mzXML</code>/<code class="file">mzML</code> files for <em>e.g.</em> plotting chromatograms. In
  this case the centroided MS files should be stored in the same directory as the raw <code class='command'>Bruker</code> <code class="file">.d</code>
  files. The <code><a href='convertMSFiles.html'>convertMSFiles</a></code> function can be used to centroid data.</p>
<p><code>makeSet</code> Currently does not support making sets from <code><a href='featureGroups-class.html'>featureGroupsSet</a></code> objects.</p>
    <h2 class="hasAnchor" id="sets-workflows"><a class="anchor" href="#sets-workflows"></a>Sets workflows</h2>

    <p>With a <a href='sets-workflow.html'>sets workflow</a> the features are first neutralized, <em>i.e.</em>
  their <em>m/z</em> values is replaced by their neutral monoisotopic mass. The latter is calculated from adduct
  annotations, specified either directly, or already present in the input objects. The features are then grouped by
  any of the <code>groupFeatures</code> algorithms. The neutralization step ensures that features measured with <em>e.g.</em>
  different ionization polarities can be grouped since their neutral mass will be the same. The sets workflow is
  initiated in either of the following two ways:</p><ol>
<li><p>The <code>groupFeatures</code> method can be called with a <code><a href='features-class.html'>featuresSet</a></code> object (generated with the
  <a href='feature-finding.html'>features method</a> of <code>makeSet</code>).</p></li>
<li><p>By using the <code>makeSet</code> method for <code>featureGroups</code>. This uses the
  <a href='feature-finding.html'>features method</a> internally to first create a <code><a href='features-class.html'>featuresSet</a></code> object from
  all the feature data inside the input <code>featureGroups</code> objects. The (neutralized) features are then
  (re-)grouped with <code>groupFeatures</code>.</p></li>
</ol>

<p>The advantage of the second method is that it preserves adduct annotations present in the input
  <code>featureGroups</code> objects (<em>e.g.</em> as set by <code>selectIons</code> or <code>adducts&lt;-</code>). Furthermore, the second
  approach allows more advanced workflows where the input <code>featureGroups</code> are first pre-treated with <em>e.g.</em>
  filter before the sets object is made. On the other hand, the first approach is easier as it doesn't require
  intermediate feature grouping steps, and is often sufficient as adduct annotations can be made afterwards with
  <code>selectIons</code>/<code>adducts&lt;-</code>, and most <code>filter</code> operations do not need to be done per individual set.</p>
<p>With both approaches the resulting <code><a href='featureGroups-class.html'>featureGroupsSet</a></code> object will contain adduct annotations, either
  based on those already present from input <code>featureGroups</code> objects or as specified by the <code>adducts</code>
  argument to <code>makeSet</code>.</p>
<p><strong>NOTE</strong> the <code>loadRawData</code> and arguments related to retention time alignment (<em>e.g.</em> <code>rtalign</code>,
  <code>retcorArgs</code>) are currently not supported for sets workflows when using algorithms from <span class="pkg">KPIC2</span> or
  <span class="pkg">XCMS</span>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ji H, Zeng F, Xu Y, Lu H, Zhang Z (2017).
&#8220;KPIC2: An Effective Framework for Mass Spectrometry-Based Metabolomics Using Pure Ion Chromatograms.&#8221;
<em>Analytical Chemistry</em>, <b>89</b>(14), 7631--7640.
doi: <a href='https://doi.org/10.1021/acs.analchem.7b01547'>10.1021/acs.analchem.7b01547</a>
.</p>
<p>Rost HL, Sachsenberg T, Aiche S, Bielow C, Weisser H, Aicheler F, Andreotti S, Ehrlich H, Gutenbrunner P, Kenar E, Liang X, Nahnsen S, Nilse L, Pfeuffer J, Rosenberger G, Rurik M, Schmitt U, Veit J, Walzer M, Wojnar D, Wolski WE, Schilling O, Choudhary JS, Malmstrom L, Aebersold R, Reinert K, Kohlbacher O (2016).
&#8220;OpenMS: a flexible open-source software platform for mass spectrometry data analysis.&#8221;
<em>Nature Methods</em>, <b>13</b>(9), 741--748.
doi: <a href='https://doi.org/10.1038/nmeth.3959'>10.1038/nmeth.3959</a>
.
 <br /><br />
  <a href='https://pugixml.org/'>pugixml</a> (via <a href='http://www.rcpp.org/'>Rcpp</a>) is used to process OpenMS XML output. <br /><br />
  Dirk Eddelbuettel and Romain Francois (2011). Rcpp: Seamless R and C++ Integration. Journal of Statistical Software, 40(8), 1-18,  <doi:10.18637/jss.v040.i08>. <br /><br />
  Eddelbuettel, Dirk (2013) Seamless R and C++ Integration with Rcpp, Springer, New York, ISBN 978-1-4614-6867-7, <doi:10.1007/978-1-4614-6868-4>. <br /><br />
  Dirk Eddelbuettel and James Joseph Balamuta (2018). Extending R with C++: A Brief Introduction to Rcpp. The American Statistician. 72(1), <doi:10.1080/00031305.2017.1375990>.</p>
<p>Duhrkop K, Fleischauer M, Ludwig M, Aksenov AA, Melnik AV, Meusel M, Dorrestein PC, Rousu J, Bocker S (2019).
&#8220;SIRIUS 4: a rapid tool for turning tandem mass spectra into metabolite structure information.&#8221;
<em>Nature Methods</em>, <b>16</b>(4), 299--302.
doi: <a href='https://doi.org/10.1038/s41592-019-0344-8'>10.1038/s41592-019-0344-8</a>
.</p>
<p>Smith, C.A. and Want, E.J. and O'Maille, G. and Abagyan,R. and Siuzdak, G.: XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification, Analytical Chemistry, 78:779-787 (2006) <br /><br /> Ralf Tautenhahn, Christoph Boettcher, Steffen Neumann: Highly sensitive feature detection for high resolution LC/MS BMC Bioinformatics, 9:504 (2008) <br /><br /> H. Paul Benton, Elizabeth J. Want and Timothy M. D. Ebbels Correction of mass calibration gaps in liquid chromatography-mass spectrometry metabolomics data Bioinformatics, 26:2488 (2010)</p>
<p>Smith, C.A. and Want, E.J. and O'Maille, G. and Abagyan,R. and Siuzdak, G.: XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification, Analytical Chemistry, 78:779-787 (2006) <br /><br /> Ralf Tautenhahn, Christoph Boettcher, Steffen Neumann: Highly sensitive feature detection for high resolution LC/MS BMC Bioinformatics, 9:504 (2008) <br /><br /> H. Paul Benton, Elizabeth J. Want and Timothy M. D. Ebbels Correction of mass calibration gaps in liquid chromatography-mass spectrometry metabolomics data Bioinformatics, 26:2488 (2010)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='featureGroups-class.html'>featureGroups-class</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Rick Helmus.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


