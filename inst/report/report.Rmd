---
title: "report"
author: "`r getPackageName(create = FALSE)`"
date: "`r if (!properties$noDate) date() else '' `"
output:
    flexdashboard::flex_dashboard:
        vertical_layout: fill
        mathjax: null
        fig_mobile: false
        dev: svg
        theme:
            version: 3
            bootswatch: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.keep = "all", fig.retina = 1, dpi = 72)

```

<style>
pre, code {
    white-space: pre !important;
    overflow-x: auto !important;
    max-height: 275px;
    overflow-y: auto;
}

/* set positioning to allow scaling: https://stackoverflow.com/a/45144857 */
/* UNDONE: doesn't work...
.svglite {
    position: absolute;
    width: 100%;
    height: auto;
}*/

/* Image zooming, based on https://stackoverflow.com/a/57694495 */
.zoomDiv {
    opacity: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    z-index: 50;
    transform: translate(-50%, -50%);
    box-shadow: 0px 0px 50px #888888;
    max-height: 100%; 
    overflow: auto;
    cursor: zoom-out;
}

.zoomImg {
    width: 100%;
}

img:not(.zoomImg) {
    cursor: zoom-in;
    max-width: 100%;
}

</style>

<script type="text/javascript">
    // Image zooming, based on https://stackoverflow.com/a/57694495
    $(document).ready(function() {
        $('body').prepend("<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>");
        $('img:not(.zoomImg)').click(function() {
           $('.zoomImg').attr('src', $(this).attr('src'));
           $('.zoomDiv').css({opacity: '1', width: '70%'});
        });
        $('img.zoomImg').click(function() {
           $('.zoomDiv').css({opacity: '0', width: '0%'});
        });
    });
</script>

Summary {data-orientation=columns}
================

## { data-width=500 }

### Most intense feature of each group 

```{r, results = "asis"}
printf("%s\n\n", generator$plotImg(plots$overview$chroms))
```

### Retention vs m/z

```{r, results = "asis"}
printf("%s\n\n", generator$plotImg(plots$overview$retMZ))
```

## { data-width=300 }

### Objects { data-height=100 }

```{r obj-show}
cat(objectsShow)
```


```{r, results = "asis", eval = !is.null(plots$overview$chord) || !is.null(plots$overview$venn) || is.null(plots$overview$UpSet)}
cat("### Feature distribution { data-height=200 }\n\n")
if (!is.null(plots$overview$chord))
    printf("#### Chord diagram\n\n%s\n\n", generator$plotImg(plots$overview$chord))
if (!is.null(plots$overview$venn))
    printf("#### Venn diagram\n\n%s\n\n", generator$plotImg(plots$overview$venn))
if (!is.null(plots$overview$UpSet))
    printf("#### UpSet diagram\n\n%s\n\n", generator$plotImg(plots$overview$UpSet))
```

```{r child="details.Rmd"}
```
